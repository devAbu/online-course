var prompt=require("prompt"),colors=require("colors/safe"),path=require("path"),os=require("os"),fs=require("fs"),utils=require("../utils");module.exports={showAWSPrompt:function(){return new Promise(function(r,e){var t={properties:{bucket:{},folder:{}}};prompt.message=null,prompt.start(),prompt.get(t,function(t,o){if(t)return void e(t);r(o)})})},showAWSConfigInputs:function(){return new Promise(function(r,e){var t={properties:{awsKey:{hidden:!0},awsSecret:{hidden:!0},awsRole:{}}};prompt.message=null,prompt.start(),prompt.get(t,function(t,o){if(t)return void e(t);r(o)})})},showPrompt:function(){return new Promise(function(r,e){var t={properties:{email:{description:colors.cyan("\nEmail"),required:!0},password:{description:colors.cyan("Password"),required:!0,hidden:!0}}};prompt.message=null,prompt.start(),prompt.get(t,function(t,o){if(t)return void e(t);r(o)})})},isLoggedIn:function(){var r=path.join(os.homedir(),".turbo_user");return 0!=fs.existsSync(r)},connectApp:function(){return new Promise(function(r,e){var t={properties:{siteId:{description:colors.cyan("\nEnter Site ID"),required:!0},apiKey:{description:colors.cyan("Enter Site API Key"),required:!0}}};prompt.message=null,prompt.start(),prompt.get(t,function(t,o){if(t)return void e(t);r(o)})})},currentUser:function(){return new Promise(function(r,e){var t=path.join(os.homedir(),".turbo_user");if(0==fs.existsSync(t))return void e(new Error("Please log in:\n$ turbo login"));utils.readFile(t).then(function(e){currentUser=JSON.parse(e),r(currentUser)}).catch(function(r){e(r)})})},isAuthorized:function(r,e){if(null==e)return!1;if(r.profile.id==e.id)return!0;for(var t=!1,o=0;o<r.collaborators.length;o++){if(r.collaborators[o].id==e.id){t=!0;break}}return t},awsConfig:function(){return new Promise(function(r,e){var t=path.join(os.homedir(),".turbo_aws_config");if(0==fs.existsSync(t))return void e(new Error("AWS Config not set. To set:\n$ turbo awsConfig"));utils.readFile(t).then(function(e){awsSettings=JSON.parse(e),r(awsSettings)}).catch(function(r){e(r)})})},awsConfigSet:function(){var r=path.join(os.homedir(),".turbo_aws_config");return 0!=fs.existsSync(r)}};